
global lambda k N M dW z;

E_sample = [-0.0211593875993838 - 0.282599224658698i,-0.0957648962616169 - 0.261365039089628i,-0.250070919977773 - 0.0497617438670732i,-0.230477251807833 - 0.0824339021231189i,-0.359352083217327 + 0.156945843750786i,-0.388525721497227 + 0.277134556230816i,-0.445801340124435 + 0.251194571236142i,-0.380452951396956 - 0.0478819063611579i,-0.445801340124435 + 0.251194571236142i,-0.388525721497227 + 0.277134556230816i,-0.359352083217327 + 0.156945843750786i,-0.230477251807833 - 0.0824339021231189i,-0.250070919977773 - 0.0497617438670732i,-0.0957648962616169 - 0.261365039089628i,-0.0211593875993838 - 0.282599224658698i;0.221790870134410 - 0.0684196590872940i,0.260585017695086 - 0.124733276423353i,0.345105184869026 - 0.117453166422023i,0.210440005228138 - 0.102864984814017i,0.0164325566312470 - 0.0361895058432335i,-0.201662308876346 + 0.172496441118729i,-0.266059207162436 + 0.486005495427440i,-0.496012496272082 + 0.237407176055826i,-0.266059207162436 + 0.486005495427440i,-0.201662308876346 + 0.172496441118729i,0.0164325566312470 - 0.0361895058432335i,0.210440005228138 - 0.102864984814017i,0.345105184869026 - 0.117453166422023i,0.260585017695086 - 0.124733276423353i,0.221790870134410 - 0.0684196590872940i;-0.210575088589200 - 0.117377668288259i,-0.369003117507788 + 0.105375092229088i,-0.290454839252825 - 0.0773507862974042i,-0.0348809782807736 + 0.124985931140724i,-0.0376520169772154 + 0.307743392420923i,-0.108564422396029 + 0.248153935437861i,0.168993159340858 + 0.281358695809617i,0.352718805824171 + 0.591640102652269i,0.168993159340858 + 0.281358695809617i,-0.108564422396029 + 0.248153935437861i,-0.0376520169772154 + 0.307743392420923i,-0.0348809782807736 + 0.124985931140724i,-0.290454839252825 - 0.0773507862974042i,-0.369003117507788 + 0.105375092229088i,-0.210575088589200 - 0.117377668288259i;-0.271302621332376 + 0.0227849977407641i,-0.302494484411755 - 0.0564217030632590i,-0.365401185518816 - 0.0538781566970816i,-0.354795673559495 - 0.387579802089489i,-0.189844647880688 - 0.0712530469127681i,-0.0807299872594491 - 0.389900743157215i,0.0181136789837176 - 0.0525063533551179i,0.156907214989061 - 0.300678556769789i,0.0181136789837176 - 0.0525063533551179i,-0.0807299872594491 - 0.389900743157215i,-0.189844647880688 - 0.0712530469127682i,-0.354795673559495 - 0.387579802089489i,-0.365401185518816 - 0.0538781566970816i,-0.302494484411755 - 0.0564217030632590i,-0.271302621332376 + 0.0227849977407641i;-0.187669288441409 + 0.157607998541549i,-0.265857929399872 + 0.268541400318613i,-0.375277612626068 + 0.262734859466767i,-0.338942729549590 - 0.103689325111089i,-0.209279822985861 - 0.200721759024033i,0.0707300516324585 - 0.0979117220736318i,0.495468304493255 - 0.111547943897799i,0.650203459571963 - 0.454352042870881i,0.495468304493254 - 0.111547943897799i,0.0707300516324584 - 0.0979117220736318i,-0.209279822985861 - 0.200721759024033i,-0.338942729549590 - 0.103689325111089i,-0.375277612626068 + 0.262734859466767i,-0.265857929399872 + 0.268541400318613i,-0.187669288441409 + 0.157607998541549i;0.121181928980950 - 0.376107106544794i,0.0601882281579854 - 0.444489021068623i,-0.0626281754408699 - 0.565634833047249i,-0.229360150136919 - 0.590383859589889i,-0.256564237900888 - 0.675326107463361i,-0.404379583555063 - 0.553207864242405i,-0.505255150136955 - 0.555180015984043i,-0.642973619182003 - 0.512581335546127i,-0.505255150136955 - 0.555180015984043i,-0.404379583555063 - 0.553207864242405i,-0.256564237900888 - 0.675326107463361i,-0.229360150136919 - 0.590383859589889i,-0.0626281754408699 - 0.565634833047249i,0.0601882281579854 - 0.444489021068623i,0.121181928980950 - 0.376107106544794i;-0.221942760564058 + 0.627592207081559i,0.0175155695939615 + 0.689819504768545i,0.314065798408735 + 0.590653840966641i,0.281071362413372 + 0.280920028827270i,0.195577110823499 - 0.0828832979473679i,0.310589736131285 - 0.317230619455785i,-0.00425243942348504 - 0.683851647098433i,-0.391072722860830 - 0.920359780430575i,-0.00425243942348504 - 0.683851647098433i,0.310589736131285 - 0.317230619455784i,0.195577110823499 - 0.0828832979473679i,0.281071362413372 + 0.280920028827270i,0.314065798408735 + 0.590653840966641i,0.0175155695939615 + 0.689819504768545i,-0.221942760564058 + 0.627592207081559i;-0.194989130116520 + 0.392932947774517i,-0.301219458140023 + 0.0662674567745333i,-0.219511213219574 - 0.0239032431325191i,-0.0825790596217962 + 0.180363005046536i,0.247757392497141 - 0.0799128021436443i,0.481443460495995 + 0.148600197414405i,0.764899006919430 + 0.266105332522191i,0.520799433130250 + 0.595694945635397i,0.764899006919430 + 0.266105332522191i,0.481443460495995 + 0.148600197414405i,0.247757392497141 - 0.0799128021436443i,-0.0825790596217962 + 0.180363005046536i,-0.219511213219574 - 0.0239032431325192i,-0.301219458140023 + 0.0662674567745333i,-0.194989130116520 + 0.392932947774517i;-0.221942760564058 + 0.627592207081559i,0.0175155695939615 + 0.689819504768545i,0.314065798408735 + 0.590653840966641i,0.281071362413372 + 0.280920028827270i,0.195577110823499 - 0.0828832979473679i,0.310589736131285 - 0.317230619455785i,-0.00425243942348504 - 0.683851647098433i,-0.391072722860830 - 0.920359780430575i,-0.00425243942348504 - 0.683851647098433i,0.310589736131285 - 0.317230619455784i,0.195577110823499 - 0.0828832979473679i,0.281071362413372 + 0.280920028827270i,0.314065798408735 + 0.590653840966641i,0.0175155695939615 + 0.689819504768545i,-0.221942760564058 + 0.627592207081559i;0.121181928980950 - 0.376107106544794i,0.0601882281579854 - 0.444489021068623i,-0.0626281754408699 - 0.565634833047249i,-0.229360150136919 - 0.590383859589889i,-0.256564237900888 - 0.675326107463361i,-0.404379583555063 - 0.553207864242405i,-0.505255150136955 - 0.555180015984043i,-0.642973619182003 - 0.512581335546127i,-0.505255150136955 - 0.555180015984043i,-0.404379583555063 - 0.553207864242405i,-0.256564237900888 - 0.675326107463361i,-0.229360150136919 - 0.590383859589889i,-0.0626281754408699 - 0.565634833047249i,0.0601882281579854 - 0.444489021068623i,0.121181928980950 - 0.376107106544794i;-0.187669288441409 + 0.157607998541549i,-0.265857929399872 + 0.268541400318613i,-0.375277612626068 + 0.262734859466767i,-0.338942729549590 - 0.103689325111089i,-0.209279822985861 - 0.200721759024033i,0.0707300516324585 - 0.0979117220736318i,0.495468304493255 - 0.111547943897799i,0.650203459571963 - 0.454352042870881i,0.495468304493254 - 0.111547943897799i,0.0707300516324584 - 0.0979117220736318i,-0.209279822985861 - 0.200721759024033i,-0.338942729549590 - 0.103689325111089i,-0.375277612626068 + 0.262734859466767i,-0.265857929399872 + 0.268541400318613i,-0.187669288441409 + 0.157607998541549i;-0.271302621332376 + 0.0227849977407641i,-0.302494484411755 - 0.0564217030632590i,-0.365401185518816 - 0.0538781566970816i,-0.354795673559495 - 0.387579802089489i,-0.189844647880688 - 0.0712530469127681i,-0.0807299872594491 - 0.389900743157215i,0.0181136789837176 - 0.0525063533551179i,0.156907214989061 - 0.300678556769789i,0.0181136789837176 - 0.0525063533551179i,-0.0807299872594491 - 0.389900743157215i,-0.189844647880688 - 0.0712530469127682i,-0.354795673559495 - 0.387579802089489i,-0.365401185518816 - 0.0538781566970816i,-0.302494484411755 - 0.0564217030632590i,-0.271302621332376 + 0.0227849977407641i;-0.210575088589200 - 0.117377668288259i,-0.369003117507788 + 0.105375092229088i,-0.290454839252825 - 0.0773507862974042i,-0.0348809782807736 + 0.124985931140724i,-0.0376520169772154 + 0.307743392420923i,-0.108564422396029 + 0.248153935437861i,0.168993159340858 + 0.281358695809617i,0.352718805824171 + 0.591640102652269i,0.168993159340858 + 0.281358695809617i,-0.108564422396029 + 0.248153935437861i,-0.0376520169772154 + 0.307743392420923i,-0.0348809782807736 + 0.124985931140724i,-0.290454839252825 - 0.0773507862974042i,-0.369003117507788 + 0.105375092229088i,-0.210575088589200 - 0.117377668288259i;0.221790870134410 - 0.0684196590872940i,0.260585017695086 - 0.124733276423353i,0.345105184869026 - 0.117453166422023i,0.210440005228138 - 0.102864984814017i,0.0164325566312470 - 0.0361895058432335i,-0.201662308876346 + 0.172496441118729i,-0.266059207162436 + 0.486005495427440i,-0.496012496272082 + 0.237407176055826i,-0.266059207162436 + 0.486005495427440i,-0.201662308876346 + 0.172496441118729i,0.0164325566312470 - 0.0361895058432335i,0.210440005228138 - 0.102864984814017i,0.345105184869026 - 0.117453166422023i,0.260585017695086 - 0.124733276423353i,0.221790870134410 - 0.0684196590872940i;-0.0211593875993838 - 0.282599224658698i,-0.0957648962616169 - 0.261365039089628i,-0.250070919977773 - 0.0497617438670732i,-0.230477251807833 - 0.0824339021231189i,-0.359352083217327 + 0.156945843750786i,-0.388525721497227 + 0.277134556230816i,-0.445801340124435 + 0.251194571236142i,-0.380452951396956 - 0.0478819063611579i,-0.445801340124435 + 0.251194571236142i,-0.388525721497227 + 0.277134556230816i,-0.359352083217327 + 0.156945843750786i,-0.230477251807833 - 0.0824339021231189i,-0.250070919977773 - 0.0497617438670732i,-0.0957648962616169 - 0.261365039089628i,-0.0211593875993838 - 0.282599224658698i];

dW = 20e-6; %Spacing between elements
z = 100e-6; % Distance of Image plane from the resonator plane

lambda = 1.550e-6;
k = 2 * pi / lambda;
[N, M] = size(E_sample); % Image plane discretization size

figure;
imagesc(abs(E_sample));
colormap jet
colorbar
title('Sample Plane Amplitude')
set(gcf, 'Position', [00, 00, 350, 300])
set(gca,'FontSize', 12) % Font Size

figure;
imagesc(angle(E_sample));
colormap jet
colorbar
title('Sample Plane Phase')
set(gcf, 'Position', [00, 00, 350, 300])
set(gca,'FontSize', 12) % Font Size

E_HoloPlane = HologramHelperClass.supperposition(conj(E_sample));

figure;
imagesc(abs(E_HoloPlane));
colormap gray
colorbar
title('Image Plane Amplitude')
set(gcf, 'Position', [00, 00, 350, 300])
set(gca,'FontSize', 12) % Font Size

figure;
imagesc(angle(E_HoloPlane));
colormap jet
colorbar
title('Image Plane Phase')
set(gcf, 'Position', [00, 00, 350, 300])
set(gca,'FontSize', 12) % Font Size

